<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.runjian.auth.server.mapper.ApiInfoMapper">

    <select id="MySelectPage" resultType="com.runjian.auth.server.domain.vo.system.SysApiInfoVO">
        SELECT
            sai.id,
            sai.api_pid,
            sai.api_name,
            sai.api_sort,
            sai.url,
            sai.level
        FROM
            api_info sai
        WHERE
            sai.delete_flag = 0
    </select>

    <select id="selectApiInfoByRoleCode" resultType="com.runjian.auth.server.domain.entity.ApiInfo">
        SELECT sai.*
        FROM api_info sai
            LEFT JOIN role_api sra ON sra.api_id = sai.id
            LEFT JOIN role_info sri ON sri.id = sra.role_id
        WHERE sri.role_code = #{roleCode}
    </select>

    <select id="selectApiUrlByRoleCode" resultType="java.lang.String">
        SELECT sai.url
        FROM api_info sai
            LEFT JOIN role_api sra ON sra.api_id = sai.id
            LEFT JOIN role_info sri ON sri.id = sra.role_id
        WHERE sri.role_code = #{roleCode}
    </select>

    <select id="findApiIdListByRoleId" resultType="java.lang.Long">
        SELECT org_id
        FROM role_org
        WHERE role_org.role_id = #{roleId,jdbcType=BIGINT}
    </select>
</mapper>
